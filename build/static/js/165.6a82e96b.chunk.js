"use strict";(self.webpackChunkpg_api_frontend=self.webpackChunkpg_api_frontend||[]).push([[165],{1165:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});a(5043);var n=a(9223),r=a.n(n),o=a(2450),d=a(579);const s=e=>{let{currentMonthsData:t=[]}=e;"object"!==typeof t||Array.isArray(t)||(t=Object.keys(t).map((e=>({loggerName:e,data:t[e]}))));const a=t.length>0,n=new Set;t.forEach((e=>{e.data.forEach((e=>n.add(e.date)))}));const s=Array.from(n).sort(),i=t.map((e=>e.loggerName));return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("button",{onClick:async()=>{const e=new(r().Workbook),a=e.addWorksheet("Power Generation Data"),n=[["Logger Name",...s],...i.map((e=>[e,...s.map((a=>{const n=t.find((t=>t.loggerName===e)),r=null===n||void 0===n?void 0:n.data.find((e=>e.date===a));return r?`${r.power_gen}`:"\u2014"}))]))];a.addRow(n[0]),n.slice(1).forEach((e=>a.addRow(e)));const d=await e.xlsx.writeBuffer();(0,o.saveAs)(new Blob([d]),"power_generation_data.xlsx")},className:"btn btn-sm btn-primary",children:[(0,d.jsx)("i",{className:"bi bi-file-earmark-spreadsheet"})," Download"]}),(0,d.jsx)("div",{className:"shadow border pb-3 rounded",style:{width:"100%",maxWidth:"90vw",height:"550px",overflow:"auto",position:"relative",zIndex:0},children:a?(0,d.jsxs)("table",{className:"table table-bordered",style:{borderCollapse:"collapse",fontSize:"12px"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{style:{position:"sticky",backgroundColor:"#afd1f3",textAlign:"center",padding:5,minWidth:"150px"},children:"Logger Name"}),s.map(((e,t)=>(0,d.jsx)("th",{style:{position:"sticky",top:0,backgroundColor:"#afd1f3",textAlign:"center",zIndex:1,minWidth:"120px"},children:e},t)))]})}),(0,d.jsx)("tbody",{children:i.map(((e,a)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{position:"sticky",left:0,backgroundColor:"#afd1f3",zIndex:1,textAlign:"center",padding:3,minWidth:"150px"},children:e}),s.map(((a,n)=>{const r=t.find((t=>t.loggerName===e)),o=null===r||void 0===r?void 0:r.data.find((e=>e.date===a)),s=(!o||""!==o.power_gen&&null!==o.power_gen)&&o&&parseFloat(o.power_gen)>=0?`${o.power_gen} kWh`:"\u2014";return(0,d.jsx)("td",{className:"text-center",style:{backgroundColor:"\u2014"===s||"0.0000 kWh"===s?"lightcoral":"transparent",textAlign:"center",minWidth:"120px"},children:s},n)}))]},a)))})]}):(0,d.jsx)("p",{children:"No data available"})})]})}}}]);
//# sourceMappingURL=165.6a82e96b.chunk.js.map